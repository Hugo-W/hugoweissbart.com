<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: November 28, 2025 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><script src=/js/mathjax-config.js></script>
<link rel=stylesheet href=/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script>
<link rel=stylesheet href=/css/wowchemy.e31ab33532f2f8d03ad5eb2f8c9e7b33.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Hugo Weissbart"><meta name=description content="Learn how to use TRFs, along with some tips and tricks to go further, and faster."><link rel=alternate hreflang=en-us href=https://hugoweissbart.com/tutorials/trfs/><link rel=canonical href=https://hugoweissbart.com/tutorials/trfs/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hucc679a67ce0ba819370fc3906c9c7b25_53177_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hucc679a67ce0ba819370fc3906c9c7b25_53177_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://hugoweissbart.com/media/icon_hucc679a67ce0ba819370fc3906c9c7b25_53177_512x512_fill_lanczos_center_3.png"><meta property="og:site_name" content="Random Pattern & Regular Noise"><meta property="og:url" content="https://hugoweissbart.com/tutorials/trfs/"><meta property="og:title" content="TRF tutorial | Random Pattern & Regular Noise"><meta property="og:description" content="Learn how to use TRFs, along with some tips and tricks to go further, and faster."><meta property="og:image" content="https://hugoweissbart.com/media/icon_hucc679a67ce0ba819370fc3906c9c7b25_53177_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><meta property="og:updated_time" content="2018-09-09T00:00:00+00:00"><link rel=alternate href=/tutorials/trfs/index.xml type=application/rss+xml title="Random Pattern & Regular Noise"><title>TRF tutorial | Random Pattern & Regular Noise</title><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "33f2bbad376e41c3bda0eab93fd9c1d8"}'></script></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=81b7b5a1dddf63ef5111ec2561df4461><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Random Pattern & Regular Noise</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Random Pattern & Regular Noise</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#featured><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Misc.</span></a></li><li class=nav-item><a class="nav-link active" href=/tutorials/><span>Tutorials</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class=nav-item><a class=nav-link href=/uploads/resume.pdf><span>CV</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><div class="universal-wrapper pt-3"><h1>TRF tutorial</h1></div><div class=universal-wrapper><div class=article-style><p><em>Temporal Response Functions</em> (TRFs) are, within the framework of electrophysiology and neuroscience, a type of data-driven approximate for a neural response to a stimulus.
A first analogy of the method can be made with neural receptive-fields, where one would estimate the type of filter kernel (neural response) that a given impulse in stimulus feature space would elicit.
However, digging further outside the fields of neurosciences, one can quickly compare the methodology to the like of generalised linear modelling or <a href=https://en.wikipedia.org/wiki/wiener_filter target=_blank rel=noopener>Wiener filtering</a>.</p><blockquote><p>In other words, there is absolutely <strong>nothing</strong> special about TRFs: they are probably the most rudimentary method one could think to etxract and interpret neural response to stimulus, when given a time-series</p></blockquote><h3 id=naming-issue>Naming issue</h3><p>ERP is as bad as a name as TRF, if you want to call erp &ldquo;trial-averages&rdquo;, why not? then one would get the method but not the interpreted resulting signals. Same wiht TRF&mldr;</p><p>This simply means that the term &ldquo;TRF&rdquo; is redundant to its predecessor. New to neuroscience, yet old. It could be a misnomer, as to make justice to the methodology employed one could leave the name &ldquo;linear modelling&rdquo; but that withdraw the temporal aspect included
in the framework, or then Wiener filter (which it is exactly), but than blur the definition to other than signal processing engineers, &ldquo;time-lagged regression&rdquo; maybe? But that would sound like we are only trying to please statistician. Maybe it&rsquo;s indeed a name per field.
An important difference between TRF and all other method names out there (albeit them being the same underlying maths), is that in the case of the TRFs, we, as neuroscientist, directrly <em>interpret</em> and <em>analyse</em> the resulting regression coefficients <strong>as if they were neural signals.</strong></p><p>The techniques or algorithms used to estimate the temporal response functions are</p><h1 id=linear-models-recap>Linear models: recap</h1><p><em>Temporal response functions</em> basically belongs to the family of linear models. Specifically to convolutive linear model, in our case, applied to electrophysiological data:</p><p>$$
y(t) = (x \star \beta) (t)
$$</p><p>In the context of finite computation the convolution is both discrete and finite. In other words, our convolution is simply a linear combination of the input signal $x$ with the filter/TRF coefficients $\beta$ at different lags:</p><p>$$
y[n] = \sum_{k=\tau_{min}}^{\tau_{max}} x[n-k] \beta[k]
$$</p><p>where $n$ is the time index, $k$ is the lag index, and $\tau_{min}$ and $\tau_{max}$ are the minimum and maximum lags, respectively.</p><p>This last equation can be written in matrix form as:</p><p>$$
\mathbf{y} = \mathbf{X} \mathbf{\beta}
$$</p><p>where $y$ is the response vector, $X$ is the design matrix, and $\beta$ is the vector of coefficients. Here we finally recover the general form of a <a href=https://en.wikipedia.org/wiki/Linear_model target=_blank rel=noopener>linear model</a> $y = X \beta$.</p><p>In our case, we generally have acces to a large number of samples compared to the number of features. That is, X has more rows than columns. We can retrieve the pseudo-inverse, and least squares solution of our model by solving the normal equation. To do so, we first left-multiply both sides of the equation by $X^T$:</p><p>$$
X^T y = X^T X \beta
$$</p><p>Then we solve for $\beta$:</p><p>$$
\beta = (X^T X)^{-1} X^T y
$$</p><p>This is the least squares solution of our linear model. In particular, the pseudo-inverse of $X$ is given by: $(X^T X)^{-1} X^T$. This is a simple linear multiplication, in matrix form, of our signal $y$, a sort of projection of $y$ onto the space spanned by the columns of $X$.</p><h2 id=trf-a-signal-processing-perspective>TRF: a signal processing perspective?</h2><p>In signal processing, it is well known that &ldquo;a multiplication in Fourier domain, is a convolution in time domain&rdquo; and vice-versa.
So if we were to filter a signal (removing some of its frequency content), one could imagine directly multiplying <strong>spectra</strong> of two kind:</p><ul><li>the signal&rsquo;s spectrum</li><li>some window over the frequency we want, such that we would zero out unwanted frequencies from the signal spectrum</li></ul><p>Thus, in the time domain, filtering a signal would merely correspond to a temporal convolution.
Exactly. I&rsquo;ll pass the details concerning aliasing, time discrete formulation, and finite vs infinite impulse response, but in short, yes filtering a signal boils down to convolving it with another signal (the filter <em>kernel</em>).</p><p>Now the TRF formulation directly involves a convolution and can be treated, in fact, as a filter. In that sense, we would interpret the <strong>brain as a linear, time-invariant system which transforms the input signals (stimulus features) into neural responses through a transfer function</strong>.
The transfer function thus corresponds to the filter kernel, aka the TRFs.</p><blockquote><p>A TRF is a linear filter that is applied to a stimulus to predict the response of a system. In the context of electrophysiology, the stimulus is the input to the system (e.g. the sound wave) and the response is the output of the system (e.g. the neural activity).</p></blockquote><h1 id=forward-encoding-model>Forward encoding model</h1><p>tbc</p></div><div class="media stream-item view-compact"><div class=media-body><div class="section-subheading article-title mb-0 mt-0"><a href=/tutorials/trfs/trf_app/>TRF interactive</a></div><a href=/tutorials/trfs/trf_app/ class=summary-link><div class=article-style>Learn how to use TRFs, along with some tips and tricks to go further, and faster.</div></a><div class="stream-meta article-metadata"><div class=article-metadata><span class=article-date>Last updated on
Sep 9, 2024</span></div></div></div><div class=ml-3></div></div></div></div><div class=page-footer></div><script src=/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js></script>
<script src=https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys=" crossorigin=anonymous></script>
<script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.3322c0d94f0e691b0b24c63f4c41064b.js></script>
<script src=/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.9137013a66774049159934c29c3f0205.js type=module></script></body></html>